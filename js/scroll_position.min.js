(function() {
'use strict';
const STORAGE_KEY = 'portfolioScrollPosition';
function saveScrollPosition() {
const scrollPosition = {
x: window.pageXOffset || document.documentElement.scrollLeft,
y: window.pageYOffset || document.documentElement.scrollTop,
timestamp: Date.now()
};
sessionStorage.setItem(STORAGE_KEY, JSON.stringify(scrollPosition));
}
function restoreScrollPosition() {
const savedPosition = sessionStorage.getItem(STORAGE_KEY);
if (savedPosition) {
try {
const position = JSON.parse(savedPosition);
if (Date.now() - position.timestamp < 3600000) {
requestAnimationFrame(() => {
window.scrollTo({
left: position.x,
top: position.y,
behavior: 'instant'
});
});
} else {
sessionStorage.removeItem(STORAGE_KEY);
}
} catch (e) {
sessionStorage.removeItem(STORAGE_KEY);
}
}
}
window.addEventListener('beforeunload', saveScrollPosition);
document.addEventListener('click', function(e) {
const target = e.target;
if (target.classList.contains('explore-btn') || 
target.closest('.explore-btn') ||
(target.tagName === 'A' && target.target === '_blank') ||
target.getAttribute('data-course')) {
saveScrollPosition();
}
});
let scrollSaveTimer;
window.addEventListener('scroll', function() {
clearTimeout(scrollSaveTimer);
scrollSaveTimer = setTimeout(saveScrollPosition, 500);
});
if (document.readyState === 'loading') {
document.addEventListener('DOMContentLoaded', function() {
setTimeout(restoreScrollPosition, 100);
});
} else {
setTimeout(restoreScrollPosition, 100);
}
window.addEventListener('load', function() {
setTimeout(restoreScrollPosition, 200);
});
window.addEventListener('pageshow', function(event) {
if (event.persisted) {
setTimeout(restoreScrollPosition, 100);
}
});
document.addEventListener('visibilitychange', function() {
if (document.hidden) {
saveScrollPosition();
} else {
setTimeout(restoreScrollPosition, 300);
}
});
window.addEventListener('focus', function() {
setTimeout(restoreScrollPosition, 200);
});
})();
